import{r as s,f as H,j as n,G as v,H as j,I as N,y as e,h as a}from"./index-Bqvv1m8h.js";function u(){const c=window.location.hash,[,d]=c.split("?");return new URLSearchParams(d||"").get("tab")||"top_view"}const l={banners:{label:"Banners",type:"banners"},recommended:{label:"Đề Cử",type:"recommended",generate:async()=>{await a.get("/admin/generate-random-trendings"),e.success("Đã tạo xong Top Tiên Hiệp!")}},discover:{label:"Khám phá",type:"discover"},top_view:{label:"Xem Nhiều",type:"top_view"},trending_now:{label:"Truyện Hot",type:"trending_now"},hoan_thanh:{label:"Hoàn Thành",type:"hoan-thanh",generate:async()=>{await a.get("/admin/generate-trending?category=hoan-thanh"),e.success("Đã tạo xong Top Tiên Hiệp!")}},latest:{label:"Truyện Mới",type:"latest",generate:async()=>{await a.get("/admin/generate-trending-latest"),e.success("Đã tạo xong Top Truyện Mới!")}},"latest-chapters":{label:"Truyện Hot",type:"latest-chapter"},"mien-phi":{label:"Miễn Phí",type:"mien-phi",category:"mien-phi",generate:async()=>{await a.get("/admin/generate-trending?category=mien-phi"),e.success("Đã tạo xong Top Miễn Phí!")}},premium:{label:"Premium mỗi tuần",type:"premium",category:"premium",generate:async()=>{await a.get("/admin/generate-trending?category=premium?limit=10"),e.success("Đã tạo xong Top Premium Mỗi Tuần")}},"tien-hiep":{label:"Tiên Hiệp",type:"tien-hiep",category:"tien-hiep",generate:async()=>{await a.get("/admin/generate-trending?category=tien-hiep"),e.success("Đã tạo xong Top Tiên Hiệp!")}},"huyen-huyen":{label:"Huyền Huyễn",type:"huyen-huyen",category:"huyen-huyen",generate:async()=>{await a.get("/admin/generate-trending?category=huyen-huyen"),e.success("Đã tạo xong Top Huyền Huyễn!")}},"do-thi":{label:"Đô Thị",type:"do-thi",category:"do-thi",generate:async()=>{await a.get("/admin/generate-trending?category=do-thi"),e.success("Đã tạo xong Top Đô Thị!")}},"linh-di":{label:"Linh Dị",type:"linh-di",category:"linh-di",generate:async()=>{await a.get("/admin/generate-trending?category=linh-di"),e.success("Đã tạo xong Top Linh Dị!")}},"trinh-tham":{label:"Trinh Thám",type:"trinh-tham",category:"trinh-tham",generate:async()=>{await a.get("/admin/generate-trending?category=trinh-tham"),e.success("Đã tạo xong Top Trinh Thám!")}},"he-thong":{label:"Hệ Thống",type:"he-thong",category:"he-thong",generate:async()=>{await a.get("/admin/generate-trending?category=he-thong"),e.success("Đã tạo xong Top Hệ Thống!")}},"di-gioi":{label:"Top Dị Giới",type:"di-gioi",category:"di-gioi",generate:async()=>{await a.get("/admin/generate-trending?category=di-gioi"),e.success("Đã tạo xong Top Dị Giới!")}},"co-tri":{label:"Top Cơ Trí",type:"co-tri",category:"co-tri",generate:async()=>{await a.get("/admin/generate-trending?category=co-tri"),e.success("Đã tạo xong Top Cơ Trí!")}},"trong-sinh":{label:"Trọng Sinh",type:"trong-sinh",category:"trong-sinh",generate:async()=>{await a.get("/admin/generate-trending?category=trong-sinh"),e.success("Đã tạo xong Top Trọng Sinh!")}},"hai-huoc":{label:"Hài Hước",type:"hai-huoc",category:"trong-sinh",generate:async()=>{await a.get("/admin/generate-trending?category=hai-huoc"),e.success("Đã tạo xong Top Hài Hước!")}}};function S(){const[c,d]=s.useState([]),[g,p]=s.useState(u()),[r,h]=s.useState(!1);s.useEffect(()=>{H(t=>d(t)),document.title="Bảng Xếp Hạng"},[]),s.useEffect(()=>{const t=()=>p(u());return window.addEventListener("hashchange",t),()=>window.removeEventListener("hashchange",t)},[]);const m=t=>{p(t);const i=window.location.hash,[x,f]=i.split("?"),y=new URLSearchParams(f||"");y.set("tab",t),window.location.hash=`${x}?${y.toString()}`},b=async()=>{try{h(!0),await N(),e.success("Generate Home Data thành công!")}catch{e.error("Lỗi khi generate Home Data")}finally{h(!1)}},w=async()=>{try{h(!0);const t=Object.values(l).filter(i=>i.generate);for(const i of t)await i.generate?.();e.success("Đã tạo xong tất cả các Top!"),window.location.reload()}catch(t){console.error(t),e.error("Lỗi khi tạo các Top")}finally{h(!1)}},o=s.useMemo(()=>l[g],[g,l]),T=s.useMemo(()=>o?.category?c.filter(t=>t?.categories?.includes(o?.category)):c,[o?.category,c]);return n.jsxs("div",{className:"container mx-auto pt-8",children:[r&&n.jsx("div",{className:"fixed inset-0 bg-black/50 z-999 flex items-center justify-center",children:n.jsx("div",{className:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin"})}),n.jsxs("div",{className:"flex justify-end mb-5 flex-row gap-3",children:[n.jsxs("button",{onClick:w,disabled:r,className:`px-4 py-2 rounded shadow cursor-pointer flex items-center gap-2 text-white 
            ${r?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"}
          `,children:[n.jsx(v,{}),r&&n.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r?"Đang tạo...":"Tạo Top"]}),n.jsxs("button",{onClick:b,disabled:r,className:`px-4 py-2 rounded shadow cursor-pointer flex items-center gap-2 text-white 
            ${r?"bg-gray-400 cursor-not-allowed":"bg-emerald-500 hover:bg-emerald-600"}
          `,children:[r&&n.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r?"Đang tạo...":"Tạo Home Data"]})]}),n.jsx("div",{className:"flex gap-4 overflow-x-auto whitespace-nowrap no-scrollbar border-b border-gray-300 mb-6",children:Object.entries(l).map(([t,i])=>n.jsx("button",{onClick:()=>m(t),className:`px-6 py-2 text-sm font-semibold rounded-t-lg transition-all ${g===t?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-blue-600 hover:bg-gray-100"}`,children:i.label},t))}),o&&n.jsx(j,{books:T,type:o.type,title:o.label,generate:o.generate})]})}export{S as default};
