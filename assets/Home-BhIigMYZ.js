import{c as F,o as O,r as f,j as e,m as V,B as X,g as ee,a as Z,u as te,X as se,b as ae,d as re,f as G,e as ne,h as _,s as P,y as L}from"./index-BmpcmxGY.js";import{C as le}from"./cloud-upload-DWv3yddg.js";const oe=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ie=F("circle-check-big",oe);const ce=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ue=F("star",ce);const de=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],he=F("triangle-alert",de),ge=O.createContext({}),K=!0;function me({baseColor:n,highlightColor:m,width:c,height:s,borderRadius:o,circle:x,direction:h,duration:a,enableAnimation:l=K,customHighlightBackground:g}){const t={};return h==="rtl"&&(t["--animation-direction"]="reverse"),typeof a=="number"&&(t["--animation-duration"]=`${a}s`),l||(t["--pseudo-element-display"]="none"),(typeof c=="string"||typeof c=="number")&&(t.width=c),(typeof s=="string"||typeof s=="number")&&(t.height=s),(typeof o=="string"||typeof o=="number")&&(t.borderRadius=o),x&&(t.borderRadius="50%"),typeof n<"u"&&(t["--base-color"]=n),typeof m<"u"&&(t["--highlight-color"]=m),typeof g=="string"&&(t["--custom-highlight-background"]=g),t}function J({count:n=1,wrapper:m,className:c,containerClassName:s,containerTestId:o,circle:x=!1,style:h,...a}){var l,g,t;const d=O.useContext(ge),b={...a};for(const[u,p]of Object.entries(a))typeof p>"u"&&delete b[u];const S={...d,...b,circle:x},z={...h,...me(S)};let T="react-loading-skeleton";c&&(T+=` ${c}`);const A=(l=S.inline)!==null&&l!==void 0?l:!1,v=[],r=Math.ceil(n);for(let u=0;u<r;u++){let p=z;if(r>n&&u===r-1){const C=(g=p.width)!==null&&g!==void 0?g:"100%",i=n%1,y=typeof C=="number"?C*i:`calc(${C} * ${i})`;p={...p,width:y}}const N=O.createElement("span",{className:T,style:p,key:u},"â€Œ");A?v.push(N):v.push(O.createElement(O.Fragment,{key:u},N,O.createElement("br",null)))}return O.createElement("span",{className:s,"data-testid":o,"aria-live":"polite","aria-busy":(t=S.enableAnimation)!==null&&t!==void 0?t:K},m?v.map((u,p)=>O.createElement(m,{key:p},u)):v)}function fe({initialBooks:n,loading:m}){const[c,s]=f.useState(n),[o,x]=f.useState([]);f.useEffect(()=>{const a=localStorage.getItem("bookmarks");if(a)try{const l=JSON.parse(a);x(l)}catch(l){console.error("Failed to parse bookmarks:",l)}},[]),f.useEffect(()=>{if(!n)return;const a=[...n].sort((l,g)=>{const t=o.includes(l.slug),d=o.includes(g.slug);return t===d?0:t?-1:1});s(a)},[n,o]);const h=a=>{x(l=>{const t=l.includes(a)?l.filter(d=>d!==a):[a,...l];return localStorage.setItem("bookmarks",JSON.stringify(t)),t})};return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-7 gap-6",children:m?Array.from({length:21}).map((a,l)=>e.jsxs("div",{className:"flex flex-col gap-2 animate-pulse",children:[e.jsx(J,{className:"rounded-lg aspect-2/3"}),e.jsx(J,{height:20})]},l)):c.map(a=>e.jsx(V.div,{layout:"position",transition:{type:"spring",stiffness:400,damping:30},children:e.jsx(X,{slug:a.slug,currentChapter:a.currentChapter||0,title:`${a.title}`,handleClick:()=>window.open(`/Ngoc-Tieu-Cac-Admin/#/book/${a.slug}`,"_blank","noopener,noreferrer"),thumbnailUrl:ee(a.slug)||"",isBookmarked:o.includes(a.slug),onToggleBookmark:()=>h(a.slug),hasEbook:a.hasEbook,latestEbook:a.currentChapter==a.currentEbookChapter,isSeed:a.isSeed})},a.slug))})}var B={exports:{}},pe=B.exports,M;function xe(){return M||(M=1,(function(n,m){(function(c,s,o){n.exports=o(),n.exports.default=o()})("slugify",pe,function(){var c=JSON.parse(`{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","Â¢":"cent","Â£":"pound","Â¤":"currency","Â¥":"yen","Â©":"(c)","Âª":"a","Â®":"(r)","Âº":"o","Ã€":"A","Ã":"A","Ã‚":"A","Ãƒ":"A","Ã„":"A","Ã…":"A","Ã†":"AE","Ã‡":"C","Ãˆ":"E","Ã‰":"E","ÃŠ":"E","Ã‹":"E","ÃŒ":"I","Ã":"I","Ã":"I","Ã":"I","Ã":"D","Ã‘":"N","Ã’":"O","Ã“":"O","Ã”":"O","Ã•":"O","Ã–":"O","Ã˜":"O","Ã™":"U","Ãš":"U","Ã›":"U","Ãœ":"U","Ã":"Y","Ã":"TH","ÃŸ":"ss","Ã ":"a","Ã¡":"a","Ã¢":"a","Ã£":"a","Ã¤":"a","Ã¥":"a","Ã¦":"ae","Ã§":"c","Ã¨":"e","Ã©":"e","Ãª":"e","Ã«":"e","Ã¬":"i","Ã­":"i","Ã®":"i","Ã¯":"i","Ã°":"d","Ã±":"n","Ã²":"o","Ã³":"o","Ã´":"o","Ãµ":"o","Ã¶":"o","Ã¸":"o","Ã¹":"u","Ãº":"u","Ã»":"u","Ã¼":"u","Ã½":"y","Ã¾":"th","Ã¿":"y","Ä€":"A","Ä":"a","Ä‚":"A","Äƒ":"a","Ä„":"A","Ä…":"a","Ä†":"C","Ä‡":"c","ÄŒ":"C","Ä":"c","Ä":"D","Ä":"d","Ä":"DJ","Ä‘":"dj","Ä’":"E","Ä“":"e","Ä–":"E","Ä—":"e","Ä˜":"e","Ä™":"e","Äš":"E","Ä›":"e","Ä":"G","ÄŸ":"g","Ä¢":"G","Ä£":"g","Ä¨":"I","Ä©":"i","Äª":"i","Ä«":"i","Ä®":"I","Ä¯":"i","Ä°":"I","Ä±":"i","Ä¶":"k","Ä·":"k","Ä»":"L","Ä¼":"l","Ä½":"L","Ä¾":"l","Å":"L","Å‚":"l","Åƒ":"N","Å„":"n","Å…":"N","Å†":"n","Å‡":"N","Åˆ":"n","ÅŒ":"O","Å":"o","Å":"O","Å‘":"o","Å’":"OE","Å“":"oe","Å”":"R","Å•":"r","Å˜":"R","Å™":"r","Åš":"S","Å›":"s","Å":"S","ÅŸ":"s","Å ":"S","Å¡":"s","Å¢":"T","Å£":"t","Å¤":"T","Å¥":"t","Å¨":"U","Å©":"u","Åª":"u","Å«":"u","Å®":"U","Å¯":"u","Å°":"U","Å±":"u","Å²":"U","Å³":"u","Å´":"W","Åµ":"w","Å¶":"Y","Å·":"y","Å¸":"Y","Å¹":"Z","Åº":"z","Å»":"Z","Å¼":"z","Å½":"Z","Å¾":"z","Æ":"E","Æ’":"f","Æ ":"O","Æ¡":"o","Æ¯":"U","Æ°":"u","Çˆ":"LJ","Ç‰":"lj","Ç‹":"NJ","ÇŒ":"nj","È˜":"S","È™":"s","Èš":"T","È›":"t","É™":"e","Ëš":"o","Î†":"A","Îˆ":"E","Î‰":"H","ÎŠ":"I","ÎŒ":"O","Î":"Y","Î":"W","Î":"i","Î‘":"A","Î’":"B","Î“":"G","Î”":"D","Î•":"E","Î–":"Z","Î—":"H","Î˜":"8","Î™":"I","Îš":"K","Î›":"L","Îœ":"M","Î":"N","Î":"3","ÎŸ":"O","Î ":"P","Î¡":"R","Î£":"S","Î¤":"T","Î¥":"Y","Î¦":"F","Î§":"X","Î¨":"PS","Î©":"W","Îª":"I","Î«":"Y","Î¬":"a","Î­":"e","Î®":"h","Î¯":"i","Î°":"y","Î±":"a","Î²":"b","Î³":"g","Î´":"d","Îµ":"e","Î¶":"z","Î·":"h","Î¸":"8","Î¹":"i","Îº":"k","Î»":"l","Î¼":"m","Î½":"n","Î¾":"3","Î¿":"o","Ï€":"p","Ï":"r","Ï‚":"s","Ïƒ":"s","Ï„":"t","Ï…":"y","Ï†":"f","Ï‡":"x","Ïˆ":"ps","Ï‰":"w","ÏŠ":"i","Ï‹":"y","ÏŒ":"o","Ï":"y","Ï":"w","Ğ":"Yo","Ğ‚":"DJ","Ğ„":"Ye","Ğ†":"I","Ğ‡":"Yi","Ğˆ":"J","Ğ‰":"LJ","ĞŠ":"NJ","Ğ‹":"C","Ğ":"DZ","Ğ":"A","Ğ‘":"B","Ğ’":"V","Ğ“":"G","Ğ”":"D","Ğ•":"E","Ğ–":"Zh","Ğ—":"Z","Ğ˜":"I","Ğ™":"J","Ğš":"K","Ğ›":"L","Ğœ":"M","Ğ":"N","Ğ":"O","ĞŸ":"P","Ğ ":"R","Ğ¡":"S","Ğ¢":"T","Ğ£":"U","Ğ¤":"F","Ğ¥":"H","Ğ¦":"C","Ğ§":"Ch","Ğ¨":"Sh","Ğ©":"Sh","Ğª":"U","Ğ«":"Y","Ğ¬":"","Ğ­":"E","Ğ®":"Yu","Ğ¯":"Ya","Ğ°":"a","Ğ±":"b","Ğ²":"v","Ğ³":"g","Ğ´":"d","Ğµ":"e","Ğ¶":"zh","Ğ·":"z","Ğ¸":"i","Ğ¹":"j","Ğº":"k","Ğ»":"l","Ğ¼":"m","Ğ½":"n","Ğ¾":"o","Ğ¿":"p","Ñ€":"r","Ñ":"s","Ñ‚":"t","Ñƒ":"u","Ñ„":"f","Ñ…":"h","Ñ†":"c","Ñ‡":"ch","Ñˆ":"sh","Ñ‰":"sh","ÑŠ":"u","Ñ‹":"y","ÑŒ":"","Ñ":"e","Ñ":"yu","Ñ":"ya","Ñ‘":"yo","Ñ’":"dj","Ñ”":"ye","Ñ–":"i","Ñ—":"yi","Ñ˜":"j","Ñ™":"lj","Ñš":"nj","Ñ›":"c","Ñ":"u","ÑŸ":"dz","Ò":"G","Ò‘":"g","Ò’":"GH","Ò“":"gh","Òš":"KH","Ò›":"kh","Ò¢":"NG","Ò£":"ng","Ò®":"UE","Ò¯":"ue","Ò°":"U","Ò±":"u","Òº":"H","Ò»":"h","Ó˜":"AE","Ó™":"ae","Ó¨":"OE","Ó©":"oe","Ô±":"A","Ô²":"B","Ô³":"G","Ô´":"D","Ôµ":"E","Ô¶":"Z","Ô·":"E'","Ô¸":"Y'","Ô¹":"T'","Ôº":"JH","Ô»":"I","Ô¼":"L","Ô½":"X","Ô¾":"C'","Ô¿":"K","Õ€":"H","Õ":"D'","Õ‚":"GH","Õƒ":"TW","Õ„":"M","Õ…":"Y","Õ†":"N","Õ‡":"SH","Õ‰":"CH","ÕŠ":"P","Õ‹":"J","ÕŒ":"R'","Õ":"S","Õ":"V","Õ":"T","Õ":"R","Õ‘":"C","Õ“":"P'","Õ”":"Q'","Õ•":"O''","Õ–":"F","Ö‡":"EV","Ø¡":"a","Ø¢":"aa","Ø£":"a","Ø¤":"u","Ø¥":"i","Ø¦":"e","Ø§":"a","Ø¨":"b","Ø©":"h","Øª":"t","Ø«":"th","Ø¬":"j","Ø­":"h","Ø®":"kh","Ø¯":"d","Ø°":"th","Ø±":"r","Ø²":"z","Ø³":"s","Ø´":"sh","Øµ":"s","Ø¶":"dh","Ø·":"t","Ø¸":"z","Ø¹":"a","Øº":"gh","Ù":"f","Ù‚":"q","Ùƒ":"k","Ù„":"l","Ù…":"m","Ù†":"n","Ù‡":"h","Ùˆ":"w","Ù‰":"a","ÙŠ":"y","Ù‹":"an","ÙŒ":"on","Ù":"en","Ù":"a","Ù":"u","Ù":"e","Ù’":"","Ù ":"0","Ù¡":"1","Ù¢":"2","Ù£":"3","Ù¤":"4","Ù¥":"5","Ù¦":"6","Ù§":"7","Ù¨":"8","Ù©":"9","Ù¾":"p","Ú†":"ch","Ú˜":"zh","Ú©":"k","Ú¯":"g","ÛŒ":"y","Û°":"0","Û±":"1","Û²":"2","Û³":"3","Û´":"4","Ûµ":"5","Û¶":"6","Û·":"7","Û¸":"8","Û¹":"9","à¸¿":"baht","áƒ":"a","áƒ‘":"b","áƒ’":"g","áƒ“":"d","áƒ”":"e","áƒ•":"v","áƒ–":"z","áƒ—":"t","áƒ˜":"i","áƒ™":"k","áƒš":"l","áƒ›":"m","áƒœ":"n","áƒ":"o","áƒ":"p","áƒŸ":"zh","áƒ ":"r","áƒ¡":"s","áƒ¢":"t","áƒ£":"u","áƒ¤":"f","áƒ¥":"k","áƒ¦":"gh","áƒ§":"q","áƒ¨":"sh","áƒ©":"ch","áƒª":"ts","áƒ«":"dz","áƒ¬":"ts","áƒ­":"ch","áƒ®":"kh","áƒ¯":"j","áƒ°":"h","á¹¢":"S","á¹£":"s","áº€":"W","áº":"w","áº‚":"W","áºƒ":"w","áº„":"W","áº…":"w","áº":"SS","áº ":"A","áº¡":"a","áº¢":"A","áº£":"a","áº¤":"A","áº¥":"a","áº¦":"A","áº§":"a","áº¨":"A","áº©":"a","áºª":"A","áº«":"a","áº¬":"A","áº­":"a","áº®":"A","áº¯":"a","áº°":"A","áº±":"a","áº²":"A","áº³":"a","áº´":"A","áºµ":"a","áº¶":"A","áº·":"a","áº¸":"E","áº¹":"e","áºº":"E","áº»":"e","áº¼":"E","áº½":"e","áº¾":"E","áº¿":"e","á»€":"E","á»":"e","á»‚":"E","á»ƒ":"e","á»„":"E","á»…":"e","á»†":"E","á»‡":"e","á»ˆ":"I","á»‰":"i","á»Š":"I","á»‹":"i","á»Œ":"O","á»":"o","á»":"O","á»":"o","á»":"O","á»‘":"o","á»’":"O","á»“":"o","á»”":"O","á»•":"o","á»–":"O","á»—":"o","á»˜":"O","á»™":"o","á»š":"O","á»›":"o","á»œ":"O","á»":"o","á»":"O","á»Ÿ":"o","á» ":"O","á»¡":"o","á»¢":"O","á»£":"o","á»¤":"U","á»¥":"u","á»¦":"U","á»§":"u","á»¨":"U","á»©":"u","á»ª":"U","á»«":"u","á»¬":"U","á»­":"u","á»®":"U","á»¯":"u","á»°":"U","á»±":"u","á»²":"Y","á»³":"y","á»´":"Y","á»µ":"y","á»¶":"Y","á»·":"y","á»¸":"Y","á»¹":"y","â€“":"-","â€˜":"'","â€™":"'","â€œ":"\\"","â€":"\\"","â€":"\\"","â€ ":"+","â€¢":"*","â€¦":"...","â‚ ":"ecu","â‚¢":"cruzeiro","â‚£":"french franc","â‚¤":"lira","â‚¥":"mill","â‚¦":"naira","â‚§":"peseta","â‚¨":"rupee","â‚©":"won","â‚ª":"new shequel","â‚«":"dong","â‚¬":"euro","â‚­":"kip","â‚®":"tugrik","â‚¯":"drachma","â‚°":"penny","â‚±":"peso","â‚²":"guarani","â‚³":"austral","â‚´":"hryvnia","â‚µ":"cedi","â‚¸":"kazakhstani tenge","â‚¹":"indian rupee","â‚º":"turkish lira","â‚½":"russian ruble","â‚¿":"bitcoin","â„ ":"sm","â„¢":"tm","âˆ‚":"d","âˆ†":"delta","âˆ‘":"sum","âˆ":"infinity","â™¥":"love","å…ƒ":"yuan","å††":"yen","ï·¼":"rial","ï»µ":"laa","ï»·":"laa","ï»¹":"lai","ï»»":"la"}`),s=JSON.parse('{"bg":{"Ğ™":"Y","Ğ¦":"Ts","Ğ©":"Sht","Ğª":"A","Ğ¬":"Y","Ğ¹":"y","Ñ†":"ts","Ñ‰":"sht","ÑŠ":"a","ÑŒ":"y"},"de":{"Ã„":"AE","Ã¤":"ae","Ã–":"OE","Ã¶":"oe","Ãœ":"UE","Ã¼":"ue","ÃŸ":"ss","%":"prozent","&":"und","|":"oder","âˆ‘":"summe","âˆ":"unendlich","â™¥":"liebe"},"es":{"%":"por ciento","&":"y","<":"menor que",">":"mayor que","|":"o","Â¢":"centavos","Â£":"libras","Â¤":"moneda","â‚£":"francos","âˆ‘":"suma","âˆ":"infinito","â™¥":"amor"},"fr":{"%":"pourcent","&":"et","<":"plus petit",">":"plus grand","|":"ou","Â¢":"centime","Â£":"livre","Â¤":"devise","â‚£":"franc","âˆ‘":"somme","âˆ":"infini","â™¥":"amour"},"pt":{"%":"porcento","&":"e","<":"menor",">":"maior","|":"ou","Â¢":"centavo","âˆ‘":"soma","Â£":"libra","âˆ":"infinito","â™¥":"amor"},"uk":{"Ğ˜":"Y","Ğ¸":"y","Ğ™":"Y","Ğ¹":"y","Ğ¦":"Ts","Ñ†":"ts","Ğ¥":"Kh","Ñ…":"kh","Ğ©":"Shch","Ñ‰":"shch","Ğ“":"H","Ğ³":"h"},"vi":{"Ä":"D","Ä‘":"d"},"da":{"Ã˜":"OE","Ã¸":"oe","Ã…":"AA","Ã¥":"aa","%":"procent","&":"og","|":"eller","$":"dollar","<":"mindre end",">":"stÃ¸rre end"},"nb":{"&":"og","Ã…":"AA","Ã†":"AE","Ã˜":"OE","Ã¥":"aa","Ã¦":"ae","Ã¸":"oe"},"it":{"&":"e"},"nl":{"&":"en"},"sv":{"&":"och","Ã…":"AA","Ã„":"AE","Ã–":"OE","Ã¥":"aa","Ã¤":"ae","Ã¶":"oe"}}');function o(x,h){if(typeof x!="string")throw new Error("slugify: string argument expected");h=typeof h=="string"?{replacement:h}:h||{};var a=s[h.locale]||{},l=h.replacement===void 0?"-":h.replacement,g=h.trim===void 0?!0:h.trim,t=x.normalize().split("").reduce(function(d,b){var S=a[b];return S===void 0&&(S=c[b]),S===void 0&&(S=b),S===l&&(S=" "),d+S.replace(h.remove||/[^\w\s$*_+~.()'"!\-:@]+/g,"")},"");return h.strict&&(t=t.replace(/[^A-Za-z0-9\s]/g,"")),g&&(t=t.trim()),t=t.replace(/\s+/g,l),h.lower&&(t=t.toLowerCase()),t}return o.extend=function(x){Object.assign(c,x)},o})})(B)),B.exports}var ye=xe();const be=Z(ye);function ke(n){if(!n)return"";const m=n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/Ä‘/g,"d").replace(/Ä/g,"D");return be(m,{lower:!0,strict:!0,trim:!0})}function I(n,m){return n?m?n.endsWith("-free")?n:`${n}-free`:n.replace(/-free$/,""):""}function Se({isOpen:n,onClose:m,onCreate:c}){const s=te(),[o,x]=f.useState({}),[h,a]=f.useState(!1),[l,g]=f.useState("idle"),[t,d]=f.useState({title:"",description:"",slug:"",tags:[],dichGia:"",tacGia:"",tagInput:"",isFree:!1});f.useEffect(()=>{},[]);const b=r=>{const u=r.target.value;d(p=>{let N=p.slug;if(!h){const C=ke(u);N=I(C,p.isFree)}return{...p,title:u,slug:N}})},S=r=>{const u=r.target.value;d(p=>({...p,slug:I(u.replace(/-free$/,""),p.isFree)})),a(!0),g("idle")},z=r=>{const{name:u,value:p}=r.target;d(N=>({...N,[u]:p}))},T=()=>{const r={};return t.title.trim()||(r.title="TiÃªu Ä‘á» khÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng."),t.slug.trim()||(r.slug="Slug khÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng."),t.tacGia.trim()||(r.tacGia="Nháº­p tÃªn tÃ¡c giáº£."),t.dichGia.trim()||(r.dichGia="Nháº­p tÃªn dá»‹ch giáº£."),l==="taken"&&(r.slug="Slug Ä‘Ã£ tá»“n táº¡i, vui lÃ²ng Ä‘á»•i slug khÃ¡c."),x(r),Object.keys(r).length===0},A=async()=>{if(!T())return alert("âš ï¸ Kiá»ƒm tra láº¡i thÃ´ng tin!");try{const r={...t,status:"Published",currentChapter:0},u=await ae(r);c&&c(u),m(),s("/")}catch(r){console.error(r),alert("âŒ Lá»—i khi lÆ°u truyá»‡n")}},v=async()=>{if(!t.slug.trim())return alert("Nháº­p slug trÆ°á»›c khi kiá»ƒm tra!");try{g("checking");const r=await re(t.slug);g(r?"available":"taken")}catch(r){console.error(r),g("idle"),alert("âŒ Lá»—i khi kiá»ƒm tra slug")}};return n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-teal-50 to-white-100 p-4",children:e.jsxs("div",{className:"relative w-full max-w-3xl bg-white/95 rounded-3xl shadow-2xl p-8 space-y-6 border border-teal-200 backdrop-blur-sm",children:[e.jsx("button",{className:"absolute top-4 right-4 text-teal-400 hover:text-teal-600",onClick:m,children:e.jsx(se,{size:24})}),e.jsx("h2",{className:"text-3xl font-medium text-teal-600 text-center",children:"ğŸ‘ Táº¡o Truyá»‡n Má»›i ğŸ‘"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-teal-500 mb-1 block",children:"TÃªn truyá»‡n"}),e.jsx("input",{value:t.title,onChange:b,className:"w-full p-3 rounded-xl border border-teal-300"})]}),[{label:"TÃ¡c giáº£",name:"tacGia"},{label:"Dá»‹ch giáº£",name:"dichGia"}].map(({label:r,name:u})=>e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-teal-500 mb-1 block",children:r}),e.jsx("input",{name:u,value:t[u],onChange:z,className:"w-full p-3 rounded-xl border border-teal-300"})]},u)),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm font-medium text-teal-500",children:"Truyá»‡n Free"}),e.jsx("button",{type:"button",onClick:()=>d(r=>{const u=!r.isFree;return{...r,isFree:u,slug:I(r.slug.replace(/-free$/,""),u)}}),className:`w-12 h-6 rounded-full p-1 transition ${t.isFree?"bg-teal-400":"bg-gray-300"}`,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow transform transition ${t.isFree?"translate-x-6":""}`})}),t.isFree&&e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"-free"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-teal-500 mb-1 block",children:"Slug"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:t.slug,onChange:S,className:"flex-1 p-3 rounded-xl border border-teal-300"}),e.jsx("button",{onClick:v,className:"px-4 bg-teal-400 text-white rounded-xl",children:"Check"})]}),l==="checking"&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Äang kiá»ƒm tra..."}),l==="available"&&e.jsx("p",{className:"text-sm text-green-600 mt-1",children:"âœ… Slug há»£p lá»‡"}),l==="taken"&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:"âŒ Slug Ä‘Ã£ tá»“n táº¡i"})]}),Object.keys(o).length>0&&e.jsx("div",{className:"bg-red-50 border border-red-200 p-3 rounded-xl",children:Object.values(o).map((r,u)=>e.jsxs("div",{className:"flex items-center gap-2 text-red-600",children:[e.jsx(he,{size:16})," ",r]},u))}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-6 py-2 bg-teal-400 text-white rounded-xl",children:[e.jsx(ie,{size:20})," LÆ°u Truyá»‡n"]})})]})}):null}function we({show:n}){return n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-white border-t-transparent"}),e.jsx("span",{className:"text-white text-sm font-medium",children:"Äang xá»­ lÃ½..."})]})}):null}var U,R;function je(){if(R)return U;R=1;class n{constructor(s){this.value=s,this.next=void 0}}class m{constructor(){this.clear()}enqueue(s){const o=new n(s);this._head?(this._tail.next=o,this._tail=o):(this._head=o,this._tail=o),this._size++}dequeue(){const s=this._head;if(s)return this._head=this._head.next,this._size--,s.value}clear(){this._head=void 0,this._tail=void 0,this._size=0}get size(){return this._size}*[Symbol.iterator](){let s=this._head;for(;s;)yield s.value,s=s.next}}return U=m,U}var Y,H;function ve(){if(H)return Y;H=1;const n=je();return Y=c=>{if(!((Number.isInteger(c)||c===1/0)&&c>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const s=new n;let o=0;const x=()=>{o--,s.size>0&&s.dequeue()()},h=async(g,t,...d)=>{o++;const b=(async()=>g(...d))();t(b);try{await b}catch{}x()},a=(g,t,...d)=>{s.enqueue(h.bind(null,g,t,...d)),(async()=>(await Promise.resolve(),o<c&&s.size>0&&s.dequeue()()))()},l=(g,...t)=>new Promise(d=>{a(g,d,...t)});return Object.defineProperties(l,{activeCount:{get:()=>o},pendingCount:{get:()=>s.size},clearQueue:{value:()=>{s.clear()}}}),l},Y}var Ne=ve();const Ce=Z(Ne);function Ae(){const[n,m]=f.useState([]),[c,s]=f.useState(1),[o,x]=f.useState(!1),[h,a]=f.useState([]),[l,g]=f.useState([]),[t,d]=f.useState(!0),[b,S]=f.useState(""),[z,T]=f.useState(["hoan-thanh","dang-ra"]),A=100,v=async i=>{T(y=>{let k;return y.includes(i)?k=y.filter(j=>j!==i):k=[...y,i],G(g,k),s(1),k})},r=async()=>{d(!0);try{const y=(await _.get("/books/slugs")).data.map(E=>E.slug),k=Ce(20),j=[];await Promise.all(y.map(E=>k(async()=>{try{await P(E),console.log("done",E)}catch{console.error("error:",E),j.push(E)}}))),j.length>0?(L.error(`CÃ³ ${j.length} slug lá»—i`),L.info(j.join(", "))):L.success("Sync thÃ nh cÃ´ng toÃ n bá»™ ğŸ‰")}catch{L.error("Lá»—i khi láº¥y danh sÃ¡ch slug")}d(!1)},u=async()=>{d(!0);const y=(await _.get("/admin/generate-category-page-data")).data.map(k=>k.slug);for(const k of y)await P(k),console.log("done",k),await new Promise(j=>setTimeout(j,500));d(!1)},p=async()=>{d(!0),await _.get("/admin/gemnerateRelativeBook"),d(!1)};f.useEffect(()=>{const i=localStorage.getItem("bookSlugs"),y=localStorage.getItem("bookmarks");if(document.title="Ngá»c TiÃªu CÃ¡c",i)try{const k=JSON.parse(i);Array.isArray(k)&&g(k)}catch{console.error("Lá»—i khi parse bookSlugs tá»« localStorage")}else G(g);if(y)try{a(JSON.parse(y))}catch{console.error("Lá»—i khi parse bookmarks tá»« localStorage")}},[]),f.useEffect(()=>{d(!0);let i=l;if(b.trim()!==""){const w=b.toLowerCase().replace(/\s+/g,"");i=l.filter(D=>{const W=D.title.toLowerCase().replace(/\s+/g,""),Q=D.slug.toLowerCase().replace(/\s+/g,"");return W.includes(w)||Q.includes(w)})}const y=i.filter(w=>h.includes(w.slug)).map(w=>w.slug),k=i.filter(w=>!h.includes(w.slug)).map(w=>w.slug),j=[...y,...k],E=(c-1)*A,$=c*A,q=j.slice(E,$);q.length>0?ne(q,w=>m(w)).finally(()=>d(!1)):m([]),d(!1)},[c,h,l,b]);const N=f.useCallback(i=>{m(y=>[i,...y])},[m]),C=Math.ceil(l.length/A);return e.jsxs("div",{className:"overflow-hidden",children:[e.jsx(we,{show:t}),e.jsxs("div",{className:"container mx-auto px-4 py-10 font-genshin text-genshin-dark",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-4xl font-bold drop-shadow-glow tracking-wide",children:"Danh SÃ¡ch Truyá»‡n"}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx("button",{onClick:()=>u(),className:"px-4 py-2 bg-red-400 text-white rounded-lg font-semibold hover:bg-yellow-500 transition-colors",children:"Category"}),e.jsx("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-yellow-400 text-white rounded-lg font-semibold hover:bg-yellow-500 transition-colors",children:"+ Táº¡o truyá»‡n"}),e.jsxs("button",{onClick:()=>r(),className:"flex flex-row px-4 py-2 bg-green-400 text-white rounded-lg font-semibold hover:bg-green-500 transition-colors",children:[e.jsx(le,{}),"Sync"]}),e.jsxs("button",{onClick:()=>p(),className:"flex flex-row px-4 py-2 bg-blue-400 text-white rounded-lg font-semibold hover:bg-blue-500 transition-colors",children:[e.jsx(ue,{}),"Táº¡o SÃ¡ch Theo TÃ¡c Giáº£"]})]})]}),e.jsxs("div",{className:"flex gap-2 my-5",children:[e.jsx("button",{onClick:()=>v("hoan-thanh"),className:`text-white py-2 w-32 rounded shadow cursor-pointer ${z.includes("hoan-thanh")?"bg-emerald-500":"bg-gray-400"}`,children:"HoÃ n ThÃ nh"}),e.jsx("button",{onClick:()=>v("dang-ra"),className:`text-white py-2 w-32 rounded shadow cursor-pointer ${z.includes("dang-ra")?"bg-emerald-500":"bg-gray-400"}`,children:"Äang Ra"})]}),e.jsx("div",{className:"mb-6",children:e.jsx("input",{type:"text",value:b,onChange:i=>{S(i.target.value),s(1)},placeholder:"TÃ¬m truyá»‡n...",className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-400"})}),e.jsx(fe,{initialBooks:n,loading:t}),!b&&e.jsxs("div",{className:"flex justify-center gap-3 mt-6",children:[e.jsx("button",{disabled:c===1,onClick:()=>s(i=>i-1),className:"px-3 py-1 bg-gray-300 rounded disabled:opacity-50",children:"TrÆ°á»›c"}),Array.from({length:C},(i,y)=>y+1).map(i=>e.jsx("button",{onClick:()=>s(i),className:`px-3 py-1 rounded ${c===i?"bg-yellow-400 text-white":"bg-gray-200"}`,children:i},i)),e.jsx("button",{disabled:c===C,onClick:()=>s(i=>i+1),className:"px-3 py-1 bg-gray-300 rounded disabled:opacity-50",children:"Sau"})]})]}),e.jsx(Se,{isOpen:o,onClose:()=>x(!1),onCreate:N})]})}export{Ae as default};
