import{r as s,f as H,j as a,I as v,J as j,K as N,y as e,h as t}from"./index-MZGQQlRR.js";function u(){const g=window.location.hash,[,d]=g.split("?");return new URLSearchParams(d||"").get("tab")||"top_view"}const l={latest:{label:"Truyện Mới",type:"latest",generate:async()=>{await t.get("/admin/generate-trending-latest"),e.success("Đã tạo xong Top Truyện Mới!")}},"latest-chapters":{label:"Truyện Hot",type:"latest-chapter"},banners:{label:"Banners",type:"banners"},recommended:{label:"Đề Cử",type:"recommended",generate:async()=>{await t.get("/admin/generate-random-trendings"),e.success("Đã tạo xong Top Tiên Hiệp!")}},discover:{label:"Khám phá",type:"discover"},top_view:{label:"Xem Nhiều",type:"top_view"},hoan_thanh:{label:"Hoàn Thành",type:"hoan-thanh",generate:async()=>{await t.get("/admin/generate-trending?category=hoan-thanh"),e.success("Đã tạo xong Top Tiên Hiệp!")}},"mien-phi":{label:"Miễn Phí",type:"mien-phi",category:"mien-phi",generate:async()=>{await t.get("/admin/generate-trending?category=mien-phi"),e.success("Đã tạo xong Top Miễn Phí!")}},premium:{label:"Premium mỗi tuần",type:"premium",category:"premium",generate:async()=>{await t.get("/admin/generate-trending?category=premium?limit=10"),e.success("Đã tạo xong Top Premium Mỗi Tuần")}},"tien-hiep":{label:"Tiên Hiệp",type:"tien-hiep",category:"tien-hiep",generate:async()=>{await t.get("/admin/generate-trending?category=tien-hiep"),e.success("Đã tạo xong Top Tiên Hiệp!")}},"huyen-huyen":{label:"Huyền Huyễn",type:"huyen-huyen",category:"huyen-huyen",generate:async()=>{await t.get("/admin/generate-trending?category=huyen-huyen"),e.success("Đã tạo xong Top Huyền Huyễn!")}},"do-thi":{label:"Đô Thị",type:"do-thi",category:"do-thi",generate:async()=>{await t.get("/admin/generate-trending?category=do-thi"),e.success("Đã tạo xong Top Đô Thị!")}},"linh-di":{label:"Linh Dị",type:"linh-di",category:"linh-di",generate:async()=>{await t.get("/admin/generate-trending?category=linh-di"),e.success("Đã tạo xong Top Linh Dị!")}},"trinh-tham":{label:"Trinh Thám",type:"trinh-tham",category:"trinh-tham",generate:async()=>{await t.get("/admin/generate-trending?category=trinh-tham"),e.success("Đã tạo xong Top Trinh Thám!")}},"he-thong":{label:"Hệ Thống",type:"he-thong",category:"he-thong",generate:async()=>{await t.get("/admin/generate-trending?category=he-thong"),e.success("Đã tạo xong Top Hệ Thống!")}},"di-gioi":{label:"Top Dị Giới",type:"di-gioi",category:"di-gioi",generate:async()=>{await t.get("/admin/generate-trending?category=di-gioi"),e.success("Đã tạo xong Top Dị Giới!")}},"co-tri":{label:"Top Cơ Trí",type:"co-tri",category:"co-tri",generate:async()=>{await t.get("/admin/generate-trending?category=co-tri"),e.success("Đã tạo xong Top Cơ Trí!")}},"trong-sinh":{label:"Trọng Sinh",type:"trong-sinh",category:"trong-sinh",generate:async()=>{await t.get("/admin/generate-trending?category=trong-sinh"),e.success("Đã tạo xong Top Trọng Sinh!")}},"hai-huoc":{label:"Hài Hước",type:"hai-huoc",category:"trong-sinh",generate:async()=>{await t.get("/admin/generate-trending?category=hai-huoc"),e.success("Đã tạo xong Top Hài Hước!")}},"ngon-tinh":{label:"Ngôn Tình",type:"ngon-tinh",category:"ngon-tinh",generate:async()=>{await t.get("/admin/generate-trending?category=ngon-tinh"),e.success("Đã tạo xong Top Ngôn Tình!")}},"nu-cuong":{label:"Nữ Cường",type:"nu-cuong",category:"nu-cuong",generate:async()=>{await t.get("/admin/generate-trending?category=nu-cuong"),e.success("Đã tạo xong Top Nữ Cường!")}}};function L(){const[g,d]=s.useState([]),[c,y]=s.useState(u()),[r,h]=s.useState(!1);s.useEffect(()=>{H(n=>d(n),!1),document.title="Bảng Xếp Hạng"},[]),s.useEffect(()=>{const n=()=>y(u());return window.addEventListener("hashchange",n),()=>window.removeEventListener("hashchange",n)},[]);const m=n=>{y(n);const i=window.location.hash,[x,f]=i.split("?"),p=new URLSearchParams(f||"");p.set("tab",n),window.location.hash=`${x}?${p.toString()}`},b=async()=>{try{h(!0),await N(),e.success("Generate Home Data thành công!")}catch{e.error("Lỗi khi generate Home Data")}finally{h(!1)}},w=async()=>{try{h(!0),await t.get("/admin/reset-trending");const n=Object.values(l).filter(i=>i.generate);for(const i of n)await i.generate?.();e.success("Đã tạo xong tất cả các Top!"),window.location.reload()}catch(n){console.error(n),e.error("Lỗi khi tạo các Top")}finally{h(!1)}},o=s.useMemo(()=>l[c],[c,l]),T=s.useMemo(()=>o?.category?g.filter(n=>n?.categories?.includes(o?.category)):g,[o?.category,g]);return a.jsxs("div",{className:"container mx-auto pt-8",children:[r&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-999 flex items-center justify-center",children:a.jsx("div",{className:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin"})}),a.jsxs("div",{className:"flex justify-end mb-5 flex-row gap-3",children:[a.jsxs("button",{onClick:w,disabled:r,className:`px-4 py-2 rounded shadow cursor-pointer flex items-center gap-2 text-white 
            ${r?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"}
          `,children:[a.jsx(v,{}),r&&a.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r?"Đang tạo...":"Tạo Top"]}),a.jsxs("button",{onClick:b,disabled:r,className:`px-4 py-2 rounded shadow cursor-pointer flex items-center gap-2 text-white 
            ${r?"bg-gray-400 cursor-not-allowed":"bg-emerald-500 hover:bg-emerald-600"}
          `,children:[r&&a.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r?"Đang tạo...":"Tạo Home Data"]})]}),a.jsx("div",{className:"flex gap-4 overflow-x-auto whitespace-nowrap no-scrollbar border-b border-gray-300 mb-6",children:Object.entries(l).map(([n,i])=>a.jsx("button",{onClick:()=>m(n),className:`px-6 py-2 text-sm font-semibold rounded-t-lg transition-all ${c===n?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-blue-600 hover:bg-gray-100"}`,children:i.label},n))}),o&&a.jsx(j,{books:T,type:o.type,title:o.label,generate:o.generate})]})}export{L as default};
